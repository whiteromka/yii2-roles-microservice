syntax = "proto3";

package rbac;

service RbacService {
    // Получить роли и разрешения пользователя
    rpc UserPermissions (UserRequest) returns (UserPermissionsResponse);

    // Получить все роли и разрешения в системе
    rpc AllUserPermissions (Empty) returns (AllUserPermissionsResponse);

    // Добавить роли и разрешения
    rpc AddRolesAndPermissions (AddRolesRequest) returns (AddRolesResponse);
}

message Empty {}

message UserRequest {
    int32 external_id = 1;
    int32 service_id = 2;
}

message AddRolesRequest {
    int32 external_id = 1;
    int32 service_id = 2;
    repeated string roles = 3;
    repeated string permissions = 4;
}

message UserPermissionsResponse {
    int32 user_id = 1;
    repeated string roles = 2;
    repeated string permissions = 3;
}

message AddRolesResponse {
    bool success = 1;
    string message = 2;
}

message AllUserPermissionsResponse {
    repeated RolePermissions items = 1;
}

message RolePermissions {
    string role = 1;
    repeated string permissions = 2;
}
